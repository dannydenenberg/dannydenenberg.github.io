<!DOCTYPE html>
<html lang="en">
  <head>
  <!-- anchors for headings -->
  <script src="../anchor.min.js"></script>

  
    <!-- Google Analytics -->
    <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-142322478-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-142322478-2');
</script>
    
    
    <!-- Katex Math -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous">

    <!-- The loading of KaTeX is deferred to speed up page rendering -->
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js" integrity="sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz" crossorigin="anonymous"></script>
  
    <!-- To automatically render math in text elements, include the auto-render extension: -->
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous" onload="renderMathInElement(document.body, {delimiters: [{ left: '$$', right: '$$', display: true },{ left: '\\[', right: '\\]', display: true },{ left: '$', right: '$', display: true },{ left: '\\(', right: '\\)', display: false },{ left: '$$$', right: '$$$', display: true }]});"></script>
<!-- END MATH --> 

    <!-- META INFO -->
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="Danny Denenberg's home page on the internet with a programming blog." />

          <!-- END META INFO -->
  <title>
    
    Linear algebra for machine learning &middot; Danny Denenberg
    
  </title>

  <!-- Font Awesome Icon Support -->
 <script src="https://kit.fontawesome.com/b0b051f3df.js" crossorigin="anonymous"></script>
  </head>


  <link rel="stylesheet" href="/styles.css" />
  <link
    rel="apple-touch-icon-precomposed"
    sizes="144x144"
    href="/public/apple-touch-icon-precomposed.png"
  />
  <link rel="shortcut icon" href="/public/favicon.ico" />
  <link
    rel="alternate"
    type="application/atom+xml"
    title="Danny Denenberg"
    href="/atom.xml"
  />


</head>


  <body>
    <div class="container content">
      <header class="masthead">
        <h3 class="masthead-title">
          <a href="/" title="Home">Danny Denenberg</a>
          <small></small>
        </h3>

         &nbsp;&nbsp;&nbsp;<span
          class="nav-bar-item"
          ><a href="/about/">About</a></span
        >
         &nbsp;&nbsp;&nbsp;<span
          class="nav-bar-item"
          ><a href="/projects">Projects</a></span
        >
        
      </header>

      <main>
        <article class="post">
  <h1 class="post-title">Linear algebra for machine learning</h1>
  <time datetime="2018-12-30T00:00:00-06:00" class="post-date"
    >December 30, 2018</time
  >

  <p><strong>Abstract</strong>
This article aims to give the reader an understanding of the linear algebra aspect of mathematics one needs to know to start programming or developing machine/deep learning models and gain an understanding of them. Each section corresponds to a unique linear algebra operation. I hope this paper is easy to read and understand to a person who has just a basic high school level understanding of mathematics.</p>

<h2 id="contents">Contents</h2>

<ol>
  <li><a href="#dimensions">Dimensions</a></li>
  <li><a href="#indexing">Indexing</a></li>
  <li><a href="#vectors">Vectors</a></li>
  <li><a href="#simple-operations">Simple Operations</a></li>
  <li><a href="#matrix-vector-multiplication">Matrix-Vector Multiplication</a></li>
  <li><a href="#matrix-matrix-multiplication">Matrix-Matrix Multiplication</a></li>
  <li><a href="#the-why">The Why</a></li>
</ol>

<h2 id="dimensions">Dimensions</h2>
<p>First of all, what the heck is a matrix? Well, a matrix is a ‚Äúrectangular array of numbers‚Äù. In simpler terms, a matrix is a grid where each square holds a value. You might be familiar with matrices in programming (also known as an ‚Äúarray of arrays‚Äù). In Java, for example, to create a matrix, you might type this: <code>int[][] mat = new int[2][2]</code>. This would initialize a ‚Äú2 by 2‚Äù matrix. Here is an example of a ‚Äú2 by 2‚Äù matrix in math:</p>
<p>$\left[\begin{array}{ll}{2} &amp; {4} \\\ {1} &amp; {3}\end{array}\right]$</p>
<p>Above is a ‚Äúmatrix of numbers‚Äù. Why did I call it ‚Äú2 by 2‚Äù? It has 2 rows and 2 columns. So, for example, this matrix would be a ‚Äú3 by 2‚Äù or just 3x2:</p>
<p>$\left[\begin{array}{ll}{1} &amp; {2} \\\ {3} &amp; {4} \\\ {5} &amp; {6}\end{array}\right]$</p>
<p>Additionally, the symbol commonly used to represent matrix dimensions is the all-real-numbers symbol: \(\mathbb{R}\). The dimensions of the previous example could be written as \(\mathbb{R}^{3 \times 2}\)</p>

<h2 id="indexing">Indexing</h2>

<p>Another very common operation needed to be performed on matrices is ‚Äúindexing‚Äù. This is where you can get one value from a matrix. So, if I call the <code>3x2</code> matrix above \(A\) , and I wanted to index the first element (1), I would say \(A_{11}\).

The reason I do this is because matrix indexing occurs by a subscript where the first number corresponds to the row and the second number corresponds the column of the element in the matrix you want to get (eg. \(Nameofmatrix\_{rowcol}\)).

Another example: let's suppose I want to index the 6 in the matrix above. It is in the 3rd row and 2nd column, so to index it I would say \(A\_{32}\) (Assuming my matrix was called \(A\)).</p>

<h2 id="vectors">Vectors</h2>
<p>A ‚Äúvector‚Äù is just a matrix but with one column <u>only</u>. You could say it is an <code>n x 1</code> matrix because it can have as many rows (n) but only one column. When indexing a vector, you only need one number in the subscript and that corresponds to the row of the number you are indexing. So, if we have this vector</p>
<p>$Y=\left[\begin{array}{l}{1} \\\ {2} \\\ {3}\end{array}\right]$</p>
<p>then, \(Y_{1}=1\), \(Y_{2}=2\), and \(Y_{3}=3\). </p>
<p><em>Just a quick note: all the indexing I have written on is what is called ‚Äú1-indexing‚Äù because the first value in the matrix is referred to with a 1. If you are familiar with programming, then you will most likely be familiar with zero-indexing, where the first value in an array (or matrix) is the 0th element. 1-indexed vectors/matrices are the <u>most common</u>. Another note: matrices and vectors are often named using CAPITOL lettering by convention.</em></p>

<h2 id="simple-operations">Simple Operations</h2>
<p>Now we will start to perform operations on matrices. For each simple operator (add, subtract, multiply, divide) there are two different matrix operations associated. The two matrix operations are known as ‚Äúscalar‚Äù and ‚Äúelement-wise‚Äù. The scalar operator takes a number and performs one operation with each element in the matrix. For example,</p>
<p>$3+\left[\begin{array}{ll}{1} &amp; {2} \\\ {3} &amp; {4}\end{array}\right]=\left[\begin{array}{ll}{1+3} &amp; {2+3} \\\ {3+3} &amp; {4+3}\end{array}\right]=\left[\begin{array}{ll}{4} &amp; {5} \\\ {6} &amp; {7}\end{array}\right]$</p>
<p>This works the same way for subtraction, multiplication, and division using scalar values. With element wise operations, you take two matrices of the SAME dimensions and perform one operation with each corresponding element in each matrix. For example:</p>
<p>$\left[\begin{array}{ll}{1} &amp; {2} \\\ {3} &amp; {4}\end{array}\right] *\left[\begin{array}{ll}{5} &amp; {4} \\\ {3} &amp; {2}\end{array}\right]=\left[\begin{array}{ll}{1 * 5} &amp; {2 * 4} \\\ {3 * 3} &amp; {4 * 2}\end{array}\right]=\left[\begin{array}{ll}{4} &amp; {8} \\\ {9} &amp; {8}\end{array}\right]$</p>
<p>Here is an example where you can't perform the element-wise operation because the two matrices do NOT have the same dimensions:</p>
<p>$\left[\begin{array}{ll}{2} &amp; {3} \\\ {4} &amp; {5}\end{array}\right]+\left[\begin{array}{lll}{1} &amp; {2} &amp; {3} \\\ {4} &amp; {5} &amp; {6}\end{array}\right]=undefined$</p>

<h2 id="matrix-vector-multiplication">Matrix-Vector Multiplication</h2>
<p>When multiplying a matrix by a vector, you take each row of the matrix and multiply each element of that row with the corresponding element in the vector and then add them. You do that for each row in the matrix and you end up with a vector with the number of rows as the original matrix. This is known as the <strong>‚Äúdot product‚Äù</strong> and is represented with this symbol: ‚Äú\(\otimes\)" (or with no symbol like 2x means to multiply 2 with x). It will make more sense once you see this example:</p>
<p>$\left[\begin{array}{ll}{1} &amp; {3} \\\ {4} &amp; {0} \\\ {2} &amp; {1}\end{array}\right] \otimes\left[\begin{array}{l}{1} \\\ {5}\end{array}\right]=\left[\begin{array}{l}{?} \\\ {?} \\\ {?}\end{array}\right]$</p>
<p>To perform the dot product, we first take the first row of the matrix, $\left[\begin{array}{ll}{1} &amp; {3}\end{array}\right]$, and multiply each element in it with the corresponding element in the vector like this:</p>
<p>$\left[\begin{array}{ll}{1} &amp; {3}\end{array}\right] *\left[\begin{array}{ll}{1} &amp; {5}\end{array}\right]=\left[\begin{array}{lll}{1 * 1} &amp; {3 * 5}\end{array}\right]=\left[\begin{array}{ll}{1} &amp; {15}\end{array}\right]$</p>
<p>Now you add the values up, $1+15=16$. This becomes the first value in the resulting matrix.</p>
<p>$\left[\begin{array}{ll}{1} &amp; {3} \\\ {4} &amp; {0} \\\ {2} &amp; {1}\end{array}\right] \otimes\left[\begin{array}{l}{1} \\\ {5}\end{array}\right]=\left[\begin{array}{c}{16} \\\ {?} \\\ {?}\end{array}\right]$	</p>
<p>You now perform these same steps with the rest of the rows in the matrix. For the sake of brevity, I will put the final operations in the matrix:</p>
<p>$\left[\begin{array}{ll}{1} &amp; {3} \\\ {4} &amp; {0} \\\ {2} &amp; {1}\end{array}\right] \otimes\left[\begin{array}{l}{1} \\\ {5}\end{array}\right]=\left[\begin{array}{c}{16} \\\ {(4 * 1+0 * 5)} \\\ {(2 * 1+1 * 5)}\end{array}\right]=\left[\begin{array}{c}{16} \\\ {4} \\\ {7}\end{array}\right]$</p>
<p>And that final matrix is the answer. It's not difficult to understand, just tedious to execute. This is why NO ONE does this by hand, we use computers to do this for us. In python, using the <a href="https://www.numpy.org/">numpy</a> library, you can just say this to perform that entire dot product: <code>numpy.dot(matrix_A, matrix_B)</code>.</p>
<p>Additionally, because the operations for dot product are so specific, you cannot perform them with just two randomly dimensioned matrices, they have to be specific as well. If the matrix has dimensions \(\mathbb{R}^{m\times n}\) (\(m\) rows, \(n\) columns), then the vector must have the dimensions \(\mathbb{R}^{n\times 1}\) (n dimensional vector). The answer would then be a vector with the dimensions \(\mathbb{R}^{m \times 1}\).</p>

<h2 id="matrix-matrix-multiplication">Matrix-Matrix Multiplication</h2>
<p>To multiply a matrix <strong>by another matrix</strong> we need to do the <strong>"dot product"</strong> of the rows and columns ... what does that mean? Well, in the previous section, we took a matrix and a vector, and for each row in the matrix, we found the dot product of that row with the vector and ended up with a vector as the result. For multiplying matrices, you do that EXACT same thing, but repeat it for each column in the second matrix acting as individual vectors. </p>
<p>This will make more sense in an example. To work out the answer for the <strong>1st row </strong>and<strong> 1st column</strong> of the resulting matrix in this problem, I would find the dot product of the <strong>1st row </strong>of the first matrix and the<strong> 1st column </strong>of the second matrix like so: </p>
<p>$\left[\begin{array}{lll}\color{blue}{1} &amp; \color{blue}{2} &amp; \color{blue}{3} \\\ {4} &amp; {5} &amp; {6}\end{array}\right] \times\left[\begin{array}{cc}\color{blue}{7} &amp; {8} \\\ \color{blue}{9} &amp; {10} \\\ \color{blue}{11} &amp; {12}\end{array}\right]=\left[\begin{array}{c}\color{blue}{58} &amp; {}\\\ {} &amp;{}\end{array}\right]$</p>
<p>$\begin{aligned}(1,2,3) \otimes(7,9,11) &amp;=1 \times 7+2 \times 9+3 \times 11 \\\ &amp;=58 \end{aligned}$</p>
<p>To work out the answer for the <strong>2nd row </strong>and<strong> 1st column </strong>of the resulting matrix, I would find the dot product of the <strong>2nd row</strong> of the first matrix and the <strong>1st column </strong>of the second like so:</p>
<p>$\left[\begin{array}{lll}{1} &amp; {2} &amp;{3} \\\ \color{blue}{4} &amp; \color {blue}{5} &amp; \color {blue}{6}\end{array}\right] \times\left[\begin{array}{cc}\color{blue}{7} &amp; {8} \\\ \color{blue}{9} &amp; {10} \\\ \color{blue}{11} &amp; {12}\end{array}\right]=\left[\begin{array}{c} {58} &amp; {}\\\ \color{blue}{139} &amp; {}\end{array}\right]$</p>
<p>$\begin{aligned}(4,5,6) \otimes(7,9,11) &amp;=4 \times 7+5 \times 9+6 \times 11 \\\ &amp;=139 \end{aligned}$</p>
<p>We can do the same thing for the <strong>1st row </strong> and the <strong>2nd column:</strong></p>
<p>$\begin{aligned}(1,2,3) \otimes(8,10,12) &amp;=1 \times 8+2 \times 10+3 \times 12 \\\ &amp;=64 \end{aligned}$</p>
<p>And for the <strong>2nd row </strong>and <strong>2nd column: </strong></p>
<p>$\begin{aligned}(4,5,6) \otimes(8,10,12) &amp;=4 \times 8+5 \times 10+6 \times 12 \\\ &amp;=154 \end{aligned}$</p>
<p>And finally, we get:</p>
<p>$\left[\begin{array}{lll}{1} &amp; {2} &amp; {3} \\\ {4} &amp; {5} &amp; {6}\end{array}\right] \times\left[\begin{array}{cc}{7} &amp; {8} \\\ {9} &amp; {10} \\\ {11} &amp; {12}\end{array}\right]=\left[\begin{array}{cc}{58} &amp; {64} \\\ {139} &amp; {154}\end{array}\right]$</p>

<h2 id="the-why">The Why</h2>

<p>Why is this important to know?</p>
<p>Well, to be honest if you aren't doing something related to mathematics or computer science (machine learning) I would struggle to give you a good reason that you need to know it. But, for machine learning, it is EXTREMELY useful. </p>
<p>When modeling the layers of a neural network in a program on a computer, each layer can be represented by a vector and the weights as a matrix. Then, when it comes time to forward propagate, the next layer of the network is calculated by the dot product of the previous layer (the vector) and the weights. There are actually many cloud computing services that have computers you can access that are specially designed to be able to perform matrix operations quickly which greatly improves the training process for a network.</p>
<p>This is all I got for this one! Please feel free to email me with any questions üëçüì¨</p>

</article>

<hr />

<div class="qna">
  <h2>Questions?</h2>
  <p>
    Have a question about this post, the right way to tell a theater joke üé≠, or
    anything else? Ask away on
    <a href="https://github.com/dannydenenberg/ama" target="_blank"
      >my AMA repo</a
    >
    or shoot me an <a href="/about" target="_blank">email</a>.
  </p>
</div>


<!-- 
<aside class="related">
  <h3>Related posts</h3>
  <ul class="related-posts">
    
    <li>
      <a href="/activation-functions-comparison">
        Activation functions comparison
        <small
          ><time datetime="2020-02-14T00:00:00-06:00">14 Feb 2020</time></small
        >
      </a>
    </li>
    
    <li>
      <a href="/complete-neural-nets">
        Complete approach to neural networks
        <small
          ><time datetime="2020-01-02T00:00:00-06:00">02 Jan 2020</time></small
        >
      </a>
    </li>
    
    <li>
      <a href="/gradient-descent-univar-lr">
        Gradient descent for univariate linear regression
        <small
          ><time datetime="2019-09-20T00:00:00-05:00">20 Sep 2019</time></small
        >
      </a>
    </li>
    
  </ul>
</aside>
 -->

      </main>

      <div class="footer" style="text-align: center">
  <a
    style="text-decoration: none"
    href="https://github.com/dannydenenberg/dannydenenberg.github.io"
    ><3</a
  >
</div>

    </div>

    

    <!-- PUt the anchors on headings -->
    <script>
      anchors.options = {
        placement: "left",
        // visible: "always"
        icon: "¬ß"
      };
      anchors.add("main h2, main h3, main h4, main h5");
    </script>
  </body>
</html>
