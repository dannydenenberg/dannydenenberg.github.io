<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Math -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous">

    <!-- The loading of KaTeX is deferred to speed up page rendering -->
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js" integrity="sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz" crossorigin="anonymous"></script>
  
    <!-- To automatically render math in text elements, include the auto-render extension: -->
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous" onload="renderMathInElement(document.body, {delimiters: [{ left: '$$', right: '$$', display: true },{ left: '\\[', right: '\\]', display: true },{ left: '$', right: '$', display: true },{ left: '\\(', right: '\\)', display: false },{ left: '$$$', right: '$$$', display: true }]});"></script>

  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <title>
    
    Taking the derivative of sigmoid &middot; Danny Denenberg
    
  </title>

  <!-- Font Awesome Icon Support -->
 <script src="https://kit.fontawesome.com/b0b051f3df.js" crossorigin="anonymous"></script>
  </head>


  <link rel="stylesheet" href="/styles.css" />
  <link
    rel="apple-touch-icon-precomposed"
    sizes="144x144"
    href="/public/apple-touch-icon-precomposed.png"
  />
  <link rel="shortcut icon" href="/public/favicon.ico" />
  <link
    rel="alternate"
    type="application/atom+xml"
    title="Danny Denenberg"
    href="/atom.xml"
  />


</head>


  <body>
    <div class="container content">
      <header class="masthead">
        <h3 class="masthead-title">
          <a href="/" title="Home">Danny Denenberg</a>
          <small></small>
        </h3>

         &nbsp;&nbsp;&nbsp;<span
          class="nav-bar-item"
          ><a href="/projects">Projects</a></span
        >
         &nbsp;&nbsp;&nbsp;<span
          class="nav-bar-item"
          ><a href="/about/">About</a></span
        >
         &nbsp;&nbsp;&nbsp;<span
          class="nav-bar-item"
          ><a href="/dod">Todo</a></span
        >
        
      </header>

      <main>
        <article class="post">
  <h1 class="post-title">Taking the derivative of sigmoid</h1>
  <time datetime="2019-02-20T00:00:00-06:00" class="post-date">February 20, 2019</time>

  <p>A comprehensive walk-through of taking the derivative of the sigmoid function.</p>

<p>One of the most frequently used activation functions in machine learning, or more specifically, neural networks is the sigmoid function. In the backpropagation step in training a neural network, you have to find the derivative of the loss function with respect to each weight in the network. To do this, you have to find the derivative of your activation function. This article aims to clear up any confusion about finding the derivative of the sigmoid function.<!--more--></p>

<p>To begin, here is the sigmoid function:</p>

<p>$\sigma(x)=\frac{1}{1+e^{-x}}$</p>

<p>For a test, take the sigmoid of 5 on your calculator. You should get 0.99330714907.</p>

<p>For the purposes of the derivative, this function can also be written as:</p>
<p>$\sigma(x)=(1+e^{-x})^{-1}$</p>

<h3 id="first-impressions">First Impressions</h3>

<p>The first thing I noticed about this function, is that it is a composition of functions. The first function being</p>
<p>$\sigma(x)=(m)^{-1}$</p>

<p>and the second being</p>
<p>$m=1+e^{-x}$</p>
<p>Recall that in Calculus, when there is a composition of functions, the derivative, is the first function with respect to the second multiplied by the second function with respect to the variable, in this case <em>x.</em> Like this:</p>
<p>$\frac{d\sigma}{dx}=\frac{d\sigma}{dm}\frac{dm}{dx}$</p>
<p>So, the derivative of the sigmoid with respect to <em>x</em> is the derivative of the sigmoid function with respect to <em>m</em> times the derivative of <em>m</em> with respect to <em>x</em>. You can think of this function composition rule as a kind of intermediate computation that results in the original derivative that you wanted by cross cancelation:</p>
<p>$\frac{d\sigma}{dx}=\frac{d\sigma}{\cancel{dm}}\frac{\cancel{dm}}{dx}=\frac{d\sigma}{dx}$</p>
<p>Now that we know the sigmoid function is a composition of functions, all we have to do to find the derivative, is:</p>
<ol><li>Find the derivative of the sigmoid function with respect to <em>m</em>, our intermediate value</li><li>Find the derivative of <em>m</em> with respect to <em>x</em></li><li>Multiply those values together</li></ol>

<h3 id="1-derivative-of-the-sigmoid-with-respect-to-m">1. Derivative of the sigmoid with respect to m</h3>

<p>Let‚Äôs look back to what the sigmoid function looks like with <em>m</em> as our intermediate value:</p>
<p>$\sigma(x)=(m)^{-1}$</p>
<p>To find the derivative of this with respect to <em>m</em> is fairly simple if we can remember the power rule:</p>
<p>$\frac{d(x^n)}{dx}=n\times x^{n-1}$</p>
<blockquote><em>The derivative of </em>x^n<em> is </em>n<em> times the derivative of </em>x<em> to the power of </em>n-1<em>.</em></blockquote>
<p>So,</p>
<p>$\frac{d(x^n)}{dx}=-1\times m^{-1-1}=-m^{-2}$</p>
<p>Now, if we substitute our original value of <em>m</em> back into the equation, we get</p>
<p>$-m^{-2}=-(1+e^{-x})^{-2}$</p>
<p>Finally,</p>
<p>$\frac{d\sigma}{dm}=-(1+e^{-x})^{-2}$</p>
<p>Yay! We completed step 1.</p>

<h3 id="2-find-the-derivative-of-m-with-respect-to-x">2. Find the derivative of m with respect to x</h3>
<p>Here‚Äôs m:</p>
<p>$m=1+e^{-x}$</p>
<p>To find the derivative, we have to find the derivative of each term with respect to <em>x. </em>The first term is easy:</p>
<p>$\frac{d(1)}{dx}=0$</p>
<p>The second term is a bit more complicated.</p>
<p>Let‚Äôs let</p>
<p>$y=e^u$</p>
<p>and</p>
<p>$u=-x$</p>
<p>We know that</p>
<p>$\frac{dy}{du}=e^u     \\      \frac{du}{dx}=-1$</p>
<p>If getting to <em>e^u </em>is not clear, please read <a href="https://www.themathpage.com/aCalc/exponential.htm">this</a>.</p>
<p>Now, using the chain rule once again,</p>
<p>$\frac{dy}{dx}=\frac{dy}{du}\frac{du}{dx}$</p>
<p>So, we just multiply those derivatives we just calculated to get the derivative with respect to <em>x:</em></p>
<p>$\frac{dy}{dx}=e^u \times (-1)=-e^u=-e^{-x}$</p>
<p>All in all for step 2,</p>
<p>$\frac{dm}{dx}=-e^{-x}$</p>

<h3 id="3-multiply-the-derivatives">3. Multiply the derivatives</h3>
<p>Recall, that once we found the two intermediate derivatives, we had to multiply them. So, here is a quick summary:</p>
<p>$\frac{d\sigma}{dx}=\frac{d\sigma}{dm}\frac{dm}{dx}$</p>
<p>$\frac{d\sigma}{dm}=-(1+e^{-x})^{-2}$</p>
<p>$\frac{dm}{dx}=-e^{-x}$</p>
<p>Now, if you remember how to multiply :), we can finally finish this!</p>
<p>$\frac{d\sigma}{dx}=-(1+e^{-x})^{-2} \times -e^{-x}=\frac{e^{-x}}{(1+e^{-x})^2}$</p>
<p>You can now take this value and use it as the derivation of the sigmoid function. An interesting thing occurs after you manipulate this result, though. It turns out that you can rewrite the derivative like this:</p>
<p>$\frac{d\sigma}{dx}=\sigma(x)(1-\sigma(x))$</p>
<p>The derivative of the sigmoid function is the sigmoid times 1 minus the sigmoid. Wow. I feel cheated. :)</p>
<p>If you even remotely enjoyed this article, keep learning about AI and deep learning! üëç

</p>

</article>

<hr />
<div class="qna" style="text-align: center">
  <h2>Questions?</h2>
  <p>
    Have a question about this post, js, GitHub, or anything else? Ask away on
    <a href="https://github.com/dannydenenberg/ama" target="_blank"
      >my AMA repo</a
    >
    or by üî´-ing me an
    <a href="/about#how-the-hell-can-i-get-in-touch-with-this-guy">email</a>.
  </p>
</div>


<!-- 
<aside class="related">
  <h3>Related posts</h3>
  <ul class="related-posts">
    
    <li>
      <a href="/gradient-descent-univar-lr">
        Gradient descent for univariate linear regression
        <small
          ><time datetime="2019-09-20T00:00:00-05:00">20 Sep 2019</time></small
        >
      </a>
    </li>
    
    <li>
      <a href="/js-dev-rust">
        A js developer‚Äôs view of rust
        <small
          ><time datetime="2019-09-13T00:00:00-05:00">13 Sep 2019</time></small
        >
      </a>
    </li>
    
    <li>
      <a href="/pass-hashing">
        A complete guide to password hashing
        <small
          ><time datetime="2019-09-10T00:00:00-05:00">10 Sep 2019</time></small
        >
      </a>
    </li>
    
  </ul>
</aside>
 -->

      </main>

      <div class="footer" style="text-align: center">
  <hr />
  <p>
    Be notified of new posts.
    <a href="/atom.xml">Subscribe to the RSS feed.</a>
  </p>

  <div id="icons">
    <a href="http://github.com/dannydenenberg">
      <img
        class="icon"
        style="display:inline;"
        src="/goods/github.svg"
        width="25"
        alt=""
        srcset=""
      />
    </a>
    <!-- <img
      class="icon"
      style="display:inline;"
      src="/goods/youtube.svg"
      width="25"
      alt=""
      srcset=""
    /> -->
  </div>
</div>

    </div>

    
  </body>
</html>
