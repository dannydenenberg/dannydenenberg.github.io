<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Document</title>

    <!-- KATEX -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.css"
      integrity="sha384-bsHo4/LA+lkZv61JspMDQB9QP1TtO4IgOf2yYS+J6VdAYLVyx1c3XKcsHh0Vy8Ws"
      crossorigin="anonymous"
    />
    <script
      defer
      src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.js"
      integrity="sha384-4z8mjH4yIpuK9dIQGR1JwbrfYsStrNK6MP+2Enhue4eyo0XlBDXOIPc8b6ZU0ajz"
      crossorigin="anonymous"
    ></script>

    <!-- mathjs -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/6.2.2/math.js"></script>
  </head>
  <body style="text-align: center">
    <h1>Howdy Dr. Sand!</h1>
    <p>
      This is a little mockup I threw together after school of some cool things
      you can do with the JS library <code>mathjs</code>.
    </p>

    <hr />

    <div style="text-align: center">
      <h3>Taking the nth derivative of some function.</h3>
      <p>
        I want to take the
        <input type="text" size="3" name="" id="nth" placeholder="2" />th
        derivative of
        <input type="text" name="" id="expr" placeholder="4x^3-7x^2" /> with
        respect to
        <input size="1" type="text" name="" id="respectTo" placeholder="x" />.

        <br /><br />
        <button style="font-size: 20px" onclick="doIt()">Calculate!</button>
      </p>

      Results appear below:

      <p id="nth-derivative"></p>

      <script>
        var parenthesis = 'keep';
  var implicit = 'hide';
        function doIt() {
          // gather variable data
          const nth = parseInt(document.getElementById("nth").value);
          const expr = document.getElementById("expr").value;
          const respectTo = document.getElementById("respectTo").value;

          const latex = math.format(
            math.simplify(nthDerivative(expr, nth, respectTo)),
            14
          );

          const answer = `${latex}`;

          katex.render(answer, document.getElementById("nth-derivative"));
        }

        function nthDerivative(expr, n, respectTo) {
          let ans = math.derivative(expr, respectTo);

          for (let i = 0; i < n - 1; i++) {
            ans = math.derivative(ans, respectTo);
          }

          return ans;
        }
      </script>

      <p>
        Here is the code I used:
        <p width="300"><script src="https://gist.github.com/dannydenenberg/3c5f3232d797ba63eae2cb1d8f2e00de.js"></script></p>
      </p>
    </div>
  </body>
</html>
